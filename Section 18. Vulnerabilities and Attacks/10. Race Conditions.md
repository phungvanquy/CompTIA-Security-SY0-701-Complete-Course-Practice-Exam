# Race Conditions â€“ Exam Summary

## What Is a Race Condition?

A **race condition** is a **software vulnerability** that occurs when:

* Multiple processes or threads access the **same resource at the same time**
* The **outcome depends on timing or execution order**
* Events do **not execute in the order intended by the developer**

ğŸ“Œ *Simple idea:*

> The computer â€œraces itself,â€ and the attacker wins by acting faster.

---

## Why Race Conditions Are Dangerous

* Hard to detect
* Often **not logged**
* Can lead to:

  * Privilege escalation
  * Data corruption
  * Unauthorized access

---

## Real-World Example: Dirty COW

* **Dirty COW (Copy-On-Write)** â€“ Linux/Android exploit (2016)
* Exploited a **race condition in kernel memory**
* Allowed:

  * Read-only files to become writable
  * **Local privilege escalation**
* Very dangerous because:

  * No log entries
  * Kernel-level access

ğŸ“Œ *Exam tip:* Dirty COW = **race condition + privilege escalation**

---

## Where Race Conditions Occur

* Memory management
* File systems
* Databases
* Multithreaded applications

---

## The 3 Types of Race Conditions (VERY IMPORTANT)

### 1. Time-of-Check (TOC)

* System **checks** a condition
* Decision is made
* Attacker changes the state **before action occurs**

ğŸ“Œ Example:

* Check account balance â†’ attacker transfers funds multiple times

---

### 2. Time-of-Use (TOU)

* Resource is **used after being checked**
* Attacker modifies it **between check and use**

ğŸ“Œ Key Point:

* TOC and TOU are **two stages of the same vulnerability**

ğŸ“Œ Exam phrase:

> **TOC/TOU = race condition**

---

### 3. Time-of-Evaluation (TOE)

* Attacker changes data **during a calculation or decision**
* Leads to incorrect results or logic errors

ğŸ“Œ Example:

* Manipulating inputs during processing

---

## Memory-Safety Tie-In

* Race conditions can occur due to:

  * Unsafe dereferencing
  * Multiple threads writing to the same memory location

---

## How to Prevent Race Conditions

### Locks & Mutexes

* **Lock**: Prevents others from accessing a resource
* **Mutex**: Mutually exclusive lock

  * Only one thread allowed at a time

ğŸ“Œ Examples:

* Database record locks
* File checkout in SharePoint
* Critical section locking in code

---

## Risk of Locks: Deadlocks

### What Is a Deadlock?

* Two or more processes wait on each other
* No one releases the lock
* System stalls

ğŸ“Œ Deadlock occurs when:

* Process A waits for B
* Process B waits for A

ğŸ“Œ Prevention:

* Proper lock design
* Careful testing
* Avoid circular dependencies

---

## Quick Memory Aids

### Race Condition Definition

**â€œOutcome depends on timing and order of execution.â€**

### Types of Race Conditions

**C-U-E**

* **C**heck (TOC)
* **U**se (TOU)
* **E**valuation (TOE)

### Mitigation

**Locks â†’ Mutexes â†’ Deadlocks (if done wrong)**

---

## Exam Takeaways

* Race conditions = **timing-based vulnerabilities**
* Dirty COW = classic race condition exploit
* TOC, TOU, TOE are **not separate flaws**, but forms of race conditions
* Best mitigation: **locks and mutexes**
* Poor locking can cause **deadlocks**
