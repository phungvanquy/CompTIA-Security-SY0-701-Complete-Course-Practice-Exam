# XSS & CSRF â€“ Exam Preparation Summary

## 1. Cross-Site Scripting (XSS)

### What is XSS?

**Cross-Site Scripting (XSS)** occurs when an attacker injects **malicious scripts** into a **trusted website**, which are then **executed in the victimâ€™s browser**.

ğŸ“Œ **Root cause:**
â¡ï¸ **Lack of proper input validation**

ğŸ“Œ **Key idea:**
The browser **trusts the site**, so it **runs the malicious script** with the siteâ€™s permissions.

---

### How XSS Works (4 Steps â€“ MEMORIZE)

1. **Find vulnerability**

   * Input fields without validation (search boxes, forms, URLs)

2. **Craft malicious input or URL**

   * Script embedded in a link or form input

3. **Trusted site returns the script**

   * Script is included in the serverâ€™s response

4. **Browser executes the script**

   * Runs with trusted site permissions

---

### What Can XSS Do?

* Steal cookies or session tokens
* Capture keystrokes or form data
* Redirect users
* Deface websites
* Install malware

---

### Types of XSS (VERY IMPORTANT)

#### 1. Reflected XSS (Non-Persistent)

* Delivered via **malicious link**
* Executes **once**
* Requires user interaction (clicking a link)

ğŸ“Œ Often seen in **URLs**

---

#### 2. Stored XSS (Persistent)

* Malicious script stored in **database**
* Executes **every time the page loads**
* More dangerous

ğŸ“Œ Common in:

* Comment sections
* Forums
* User profiles

---

#### 3. DOM-Based XSS (Client-Side)

* Exploits the **Document Object Model (DOM)**
* Runs entirely in the **browser**
* Uses client-side JavaScript

ğŸ“Œ **Exam clue:**
If you see:

* `document.cookie`
* `document.write`
* `document.location`

â¡ï¸ **DOM-based XSS**

---

### XSS Exam Tips

âœ… JavaScript in URLs â†’ **XSS**
âœ… `document.` references â†’ **DOM XSS**
âœ… Input validation failure â†’ **XSS**

---

## 2. Session Management (Foundation for CSRF)

### Why Session Management Exists

* HTTP is **stateless**
* Sessions track logged-in users

### Cookies

* **Session cookies**: Deleted when browser closes
* **Persistent cookies**: Stored until expiration

ğŸ“Œ Cookies must be:

* Encrypted
* Protected
* Unpredictable

---

## 3. Session Hijacking

### What is Session Hijacking?

An attacker **takes over an authenticated session** by:

* Stealing cookies
* Predicting session tokens

### Session Prediction

* Weak or predictable session tokens
* Allows attacker to guess valid sessions

ğŸ“Œ **Prevention:**

* Strong randomness
* Non-predictable session IDs
* Tokens reveal no user info

---

## 4. Cross-Site Request Forgery (CSRF / XSRF)

### What is CSRF?

**Cross-Site Request Forgery (CSRF)** tricks a userâ€™s browser into **performing an unwanted action** on a site **where the user is already authenticated**.

ğŸ“Œ **Key idea:**
The attacker **does NOT steal credentials** â€” they **abuse an existing session**.

---

### How CSRF Works (Simple)

1. User logs into a trusted site (bank, email)
2. Session cookie is active
3. User visits attackerâ€™s site
4. Attacker sends forged request
5. Browser includes session cookie automatically
6. Trusted site executes the action

---

### Common CSRF Targets

* Change password
* Change email address
* Transfer money
* Reset account details

ğŸ“Œ Victim may **never click anything**

---

### Requirements for CSRF

* User already authenticated
* Site relies on cookies
* No CSRF protection
* Predictable session handling

---

### CSRF Defenses (Exam-Relevant)

âœ” CSRF tokens in forms
âœ” Require current password for changes
âœ” Add randomness to requests
âœ” Use MFA / 2FA
âœ” Re-authenticate for sensitive actions

---

## XSS vs CSRF (EXAM COMPARISON)

| Feature                      | XSS            | CSRF         |
| ---------------------------- | -------------- | ------------ |
| Attacks browser?             | âœ… Yes          | âŒ No         |
| Steals data?                 | âœ… Yes          | âŒ Usually no |
| Uses existing session?       | âŒ Not required | âœ… Yes        |
| Executes script?             | âœ… Yes          | âŒ No         |
| User action without knowing? | Sometimes      | âœ… Yes        |

---

## Final Exam Memory Aids

### XSS

> **â€œInjected script runs in my browser because I trust the site.â€**

### CSRF

> **â€œMy browser performs an action because Iâ€™m already logged in.â€**

---

## One-Line Exam Rules

* **JavaScript injection â†’ XSS**
* **document.cookie â†’ DOM XSS**
* **Unwanted action while logged in â†’ CSRF**
* **Input validation failure â†’ XSS**
* **Session abuse â†’ CSRF**


