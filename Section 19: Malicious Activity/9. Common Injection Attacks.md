## Common Injection Attacks – Exam Summary

Injection attacks occur when **untrusted user input is interpreted as code or commands** by an application or system. This lesson covers **LDAP injection, command injection, and process injection**.

---

## 1. LDAP Injection

**Targets applications that use LDAP for authentication or directory searches.**

### What is LDAP?

* Lightweight Directory Access Protocol
* Used to store and retrieve:

  * Users
  * Groups
  * Application information
* Commonly used for **authentication**

### How LDAP Injection Works

* Occurs when **user input is directly inserted into an LDAP query**
* Attackers manipulate the query to return unintended results
* Similar concept to **SQL injection**

### Example

* Application builds an LDAP query using user input
* Attacker enters a wildcard (`*`)
* Result: **All users are returned**, bypassing normal restrictions

### Mitigation

* Input validation
* Input sanitization
* Never trust raw user input

---

## 2. Command Injection

**Allows attackers to execute arbitrary system commands on a server.**

### How Command Injection Works

* A web application passes user input directly to the system shell
* Attacker appends additional commands to the input

### Example Scenario

* Web app allows users to ping a host
* Legitimate input:

  ```
  ping diontraining.com
  ```
* Malicious input:

  ```
  diontraining.com && hostname
  ```
* Result:

  * Ping executes
  * Then the server reveals its hostname

### Impact

* Remote command execution
* Full server compromise
* Reverse shells and persistent access possible

### Mitigation

* Strict input validation
* Accept **only expected formats** (IP addresses or domain names)
* Ignore or block additional characters or commands
* Never pass raw input directly to shell commands

---

## 3. Process Injection

**Executes malicious code inside another legitimate running process.**

### What is Process Injection?

* Malicious code runs in the **memory space of another process**
* Allows attackers to:

  * Access memory
  * Use system and network resources
  * Gain elevated privileges
* Often **evades security detection** by hiding inside trusted processes

### Common Techniques

* DLL injection
* Process hollowing
* Process doppelganging
* Asynchronous Procedure Calls (APC)
* Portable Executable (PE) injection

### Why It’s Dangerous

* Appears as a legitimate process
* Harder for antivirus and monitoring tools to detect

### Mitigation

* Endpoint Detection and Response (EDR)
* Behavior-based security monitoring
* Kernel-level protections
* Principle of least privilege

---

## Exam Key Takeaways (Memory Friendly)

* **LDAP Injection** → Manipulates directory queries
* **Command Injection** → Executes system commands
* **Process Injection** → Hides malicious code in legit processes

**Primary Defense Across All Injection Attacks:**

* Input validation
* Input sanitization
* Least privilege
* Endpoint security solutions
